(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{298:function(e,t,a){e.exports=a.p+"static/media/eos.030ab9a6.png"},318:function(e,t,a){e.exports=a.p+"static/media/logo.65b8f33e.png"},330:function(e,t,a){e.exports=a(657)},375:function(e,t){},377:function(e,t){},39:function(e,t){var a={blockchain:"eos",protocol:"https",host:"nodes.get-scatter.com",port:443,chainId:"aca376f206b8fc25a6ed44dbdc66547c36c6c33e3a119ffbeaef943642f0e906",contract:"accountphoto"};"localhost"===window.location.hostname&&(a={blockchain:"eos",protocol:"https",host:"kylin.eoscanada.com",port:443,chainId:"5fff1dae8dc8e2fc4d5b23b2c7665c97f9e9d8edf2b6485a86ba311c25639191",contract:"zachtestnets"}),e.exports={network:a,ipfs:{host:"ipfs.infura.io",port:5001}}},409:function(e,t){},451:function(e,t){},655:function(e,t,a){},657:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),c=a(69),r=a.n(c),i=a(70),l=a(71),s=a(74),u=a(72),h=a(75),p=a(38),d=a(666),m=a(667),f=a(658),g=a(292),b=a(124),E=a.n(b),v=a(76),w=a.n(v),k=a(297),y=a.n(k),S=a(39),C=a.n(S);w.a.plugins(new y.a);var O=C.a.network,P={connect:function(e){w.a.scatter.connect("AccountPhoto").then(function(t){if(!t)return!1;var a=w.a.scatter,n={accounts:[O]};a.getIdentity(n).then(function(){var t=a.identity.accounts.find(function(e){return"eos"===e.blockchain}),n=a.eos(O,E.a,{expireInSeconds:60}),o=["".concat(t.name,"@").concat(t.authority)];e(n,t,o)}).catch(function(e){console.error(e)})})},forget:function(){w.a.scatter.forgetIdentity()}},j=a(298),I=a.n(j),z=function(e){return e?"https://ipfs.io/ipfs/".concat(e):I.a},x=a(291),H=a(665),L=a(460),M=window.IpfsApi(C.a.ipfs.host,C.a.ipfs.port,{protocol:"https"}),N=new FileReader,A=function(e,t){N.readAsArrayBuffer(e),N.addEventListener("loadend",function(e){var a=e.srcElement.result;M.files.add(L(a),function(e,a){t(e,a[0],a)})})},R=a(299),T=a(293),D=a.n(T),F=a(294),U=a(301),_=a.n(U),B=a(320),J=(a(500),function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={src:"",finalImage:"",crop:{x:10,y:10,aspect:1,width:40}},a.finalizePhoto=function(){a.props.finalizePhoto(a.state.finalImage)},a.onSelectFile=function(e){e=e[0],a.setState({src:e.preview})},a.onImageLoaded=function(){var e=Object(F.a)(D.a.mark(function e(t,n){var o;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.setState({image:t}),!n){e.next=6;break}return e.next=4,a.getCroppedImg(t,n,"newFile.jpeg");case 4:o=e.sent,a.setState({finalImage:o});case 6:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),a.onCropComplete=function(){var e=Object(F.a)(D.a.mark(function e(t,n){var o;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.getCroppedImg(a.state.image,n,"newFile.jpeg");case 2:o=e.sent,a.setState({finalImage:o});case 4:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),a.onCropChange=function(e){a.setState({crop:e})},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"getCroppedImg",value:function(e,t,a){if(e&&t&&a){var n=document.createElement("canvas");return n.width=t.width,n.height=t.height,n.getContext("2d").drawImage(e,t.x,t.y,t.width,t.height,0,0,t.width,t.height),new Promise(function(e,t){n.toBlob(function(t){t&&(t.name=a),e(t)},"image/jpeg")})}}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("div",null,!this.state.src&&o.a.createElement(B.a,{onDrop:this.onSelectFile,accept:"image/jpeg, image/jpg, image/png",style:{padding:"1em",textAlign:"center",border:"3px dashed #ddd",height:"200px",cursor:"pointer"}},"Drop your photo here, or tap to select.")),this.state.src&&o.a.createElement("div",null,o.a.createElement(_.a,{src:this.state.src,crop:this.state.crop,onImageLoaded:this.onImageLoaded,onComplete:this.onCropComplete,onChange:this.onCropChange}),o.a.createElement(m.a,{color:"green",onClick:this.finalizePhoto,disabled:!this.state.crop.width,fluid:!0},"Crop Photo")))}}]),t}(n.Component)),W=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={modalOpen:!1,isLoading:!1,uploadedHash:"",failResources:!1},a.launchModal=function(){a.setState({modalOpen:!0})},a.closeModal=function(e){e&&e.preventDefault(),a.setState({modalOpen:!1,uploadedHash:""})},a.resetUploadedHash=function(e){e&&e.preventDefault(),a.setState({uploadedHash:""})},a.finalizePhoto=function(e){a.setState({isLoading:!0}),A(e,function(e,t){console.log("calling........"),!a.state.uploadedHash&&a.state.modalOpen&&a.setState({uploadedHash:t.hash,isLoading:!1},function(){a.confirmPhoto()})})},a.confirmPhoto=function(){var e=a.props,t=e.account,n=e.authorization,o=e.contract,c=a.state.uploadedHash;o.set({account:t.name,photo_hash:c},{authorization:n}).then(function(e){console.log("res is"),console.log(e),!0===e.broadcast?(console.log("good bcast"),a.resetUploadedHash(),a.closeModal(),a.props.setPhoto(c)):(console.log("bad bcast"),alert("Unable to contact the EOS network, please try again later."))}).catch(function(e){a.setState({failResources:!0})})},a.whatToRender=function(){var e=a.state,t=e.isLoading,n=e.uploadedHash,c=e.failResources,r=a.props.account;return t?o.a.createElement("div",null,o.a.createElement("h2",null,"Storing on IPFS..."),"This may take a moment, we're currently adding your photo to multiple IPFS nodes.",o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("center",null,o.a.createElement(R.CircleLoader,{sizeUnit:"px",size:250,color:"#024359",loading:!0})),o.a.createElement("div",{className:"spacer"})):n?o.a.createElement("div",null,o.a.createElement("h2",null,"Confirm with Scatter"),"We've opened scatter for you, please confirm your new account photo.",o.a.createElement("br",null),o.a.createElement("br",null),c&&o.a.createElement("div",null,o.a.createElement(x.a,{basic:!0,color:"red",pointing:"below"},"PHOTO NOT SET! Your account may not have enough ",o.a.createElement("a",{href:"https://www.myeoskit.com/tools/bandwidth/stake",target:"_blank",rel:"noopener noreferrer"},"CPU or RAM")," to complete this action."),o.a.createElement("br",null),o.a.createElement("br",null)),o.a.createElement(m.a,{onClick:a.confirmPhoto,color:"green",fluid:!0},"Re-Launch Scatter"),o.a.createElement("img",{src:z(n),alt:"pre-cache user",style:{display:"none"}})):o.a.createElement(J,{finalizePhoto:a.finalizePhoto,closeModal:a.closeModal,account:r})},a.finalizePhoto=a.finalizePhoto.bind(Object(p.a)(Object(p.a)(a))),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement("span",null,o.a.createElement(H.a,{size:"mini",open:this.state.modalOpen,onClose:this.closeModal,closeOnDimmerClick:!1},o.a.createElement(H.a.Content,null,o.a.createElement("div",null,this.whatToRender(),o.a.createElement("div",{className:"spacer"}),o.a.createElement("div",{className:"center spacer"},o.a.createElement("a",{href:"",onClick:this.closeModal},"I've changed my mind"))))),o.a.createElement(m.a,{onClick:this.launchModal,color:"green"},"Change Photo"))}}]),t}(n.Component),Y=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={account:{},eos:"",authorization:"",contract:"",photo:z()},a.linkScatter=function(){P.connect(function(e,t,n){a.setState({eos:e,account:t,authorization:n}),e.contract(C.a.network.contract).then(function(e){a.setState({contract:e},function(){a.setPhoto()})})})},a.forgetScatter=function(){a.setState({account:{},eos:"",authorization:"",contract:"",photo:z()}),P.forget()},a.setPhoto=function(e){var t=a.state,n=t.eos,o=t.account,c=C.a.network;if(e)a.setState({photo:z(e)});else{var r=E.a.modules.format.encodeName(o.name,!1).toString();console.log("en",r),n.getTableRows({json:!0,code:c.contract,scope:c.contract,table:"photo",lower_bound:r}).then(function(e){var t=e.rows[0];t.account_name===r?(console.log("accountphoto found"),a.setState({photo:z(t.photo_hash)})):(console.log("no accountphoto found, fallback"),a.setState({photo:z()}))})}},a.setPhoto=a.setPhoto.bind(Object(p.a)(Object(p.a)(a))),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentWillUnmount",value:function(){this.forgetScatter()}},{key:"renderMain",value:function(){var e=this.state,t=e.account,a=e.eos,n=e.authorization,c=e.contract;return c?o.a.createElement("div",null,o.a.createElement(d.a.Header,null,o.a.createElement("h1",null,t.name)),"This is how you currently appear on the EOS network.",o.a.createElement("div",{className:"spacer"}),o.a.createElement(m.a,{onClick:this.forgetScatter},"Unlink"),o.a.createElement(W,{account:t,eos:a,authorization:n,contract:c,setPhoto:this.setPhoto})):o.a.createElement("div",null,"Personalize your EOS account by uploading a publicly visible photo.",o.a.createElement("div",{className:"spacer"}),o.a.createElement(m.a,{href:"https://namevault.co",target:"_blank"},"No Account?"),o.a.createElement(m.a,{onClick:this.linkScatter,color:"blue"},"Link Scatter"))}},{key:"render",value:function(){var e=this.state.photo;return o.a.createElement("div",{className:"center"},o.a.createElement(d.a,{style:{width:"100%",padding:"1.5em"},color:"grey"},o.a.createElement(f.a,{src:e}),o.a.createElement(d.a.Content,null,o.a.createElement(d.a.Description,null,this.renderMain())),o.a.createElement(d.a.Content,{extra:!0},o.a.createElement("a",{href:"https://github.com/zachalam/AccountPhoto#developer-integration",rel:"noopener noreferrer",target:"_blank"},o.a.createElement(g.a,{name:"user"}),"Developer? Integrate AccountPhoto."))))}}]),t}(n.Component),q=a(318),G=a.n(q);a(652),a(655);r.a.render(o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"center"},o.a.createElement("img",{src:G.a,alt:"accountphoto logo"})),o.a.createElement(Y,null)),document.getElementById("root"))}},[[330,2,1]]]);
//# sourceMappingURL=main.63878355.chunk.js.map